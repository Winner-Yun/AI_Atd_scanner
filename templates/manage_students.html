<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Manage Database</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&family=JetBrains+Mono:wght@400&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary: #00f2ff;
        --bg-dark: #0f172a;
        --glass-bg: rgba(30, 41, 59, 0.7);
      }
      body {
        background: var(--bg-dark);
        color: #fff;
        font-family: "Rajdhani";
      }
      .glass-card {
        background: var(--glass-bg);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
      }
      .btn-tech {
        border: 1px solid var(--primary);
        color: var(--primary);
      }
      .btn-tech:hover {
        background: var(--primary);
        color: black;
      }
    </style>
  </head>
  <body class="p-5">
    <div class="container">
      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %} {% for category, message in messages %}
      <div class="alert alert-{{ category }} mb-4">{{ message }}</div>
      {% endfor %} {% endif %} {% endwith %}

      <div class="d-flex justify-content-between align-items-center mb-5">
        <h2 class="m-0 fw-bold">
          <span class="text-danger">///</span> SYSTEM DATABASE
        </h2>
        <a
          href="{{ url_for('main.index') }}"
          class="btn btn-outline-light btn-sm rounded-pill px-4"
        >
          <i class="fa-solid fa-arrow-left me-2"></i> DASHBOARD
        </a>
      </div>

      <div class="glass-card p-4 border border-danger border-opacity-25">
        <h5
          class="text-danger mb-3 border-bottom border-secondary border-opacity-25 pb-2"
        >
          <i class="fa-solid fa-database me-2"></i> Registered Students
        </h5>
        <p class="text-white-50 small">
          <strong>Warning:</strong> Deleting a student here is
          <span class="text-danger">PERMANENT</span>. It will remove their Face
          ID data, their photos from the server, unenroll them from ALL classes,
          and delete ALL their attendance history.
        </p>

        <div class="table-responsive">
          <table
            class="table table-dark table-hover align-middle border-secondary"
          >
            <thead>
              <tr>
                <th class="text-info">Student Name / ID</th>
                <th class="text-end text-secondary">Action</th>
              </tr>
            </thead>
            <tbody>
              {% for student in all_students %}
              <tr>
                <td class="fw-bold font-monospace text-light">{{ student }}</td>
                <td class="text-end">
                  <a
                    href="{{ url_for('main.delete_student_globally_route', student_name=student) }}"
                    class="btn btn-sm btn-outline-danger border-0"
                    onclick="return confirm('CRITICAL WARNING:\n\nYou are about to DELETE {{ student }} permanently.\n\n- All Photos will be deleted.\n- All Logs will be deleted.\n- Enrollment in all classes will be removed.\n\nThis cannot be undone. Proceed?')"
                  >
                    <i class="fa-solid fa-trash me-2"></i> Delete Data
                  </a>
                </td>
              </tr>
              {% else %}
              <tr>
                <td colspan="2" class="text-center text-muted py-4">
                  No registered students found.
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </body>
</html>
